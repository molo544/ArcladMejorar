import{a as i,b as t}from"./chunk-ZPVBWA5L.js";import{c as g}from"./chunk-XOFBZKAT.js";import{p as c}from"./chunk-QIU3E5ZX.js";import{U as l,Y as u,ba as a,sa as o}from"./chunk-32OYX7MF.js";var h=class s{http=a(c);router=a(g);currentUser=o(null);isAuthenticated=o(!1);isLoading=o(!1);constructor(){this.loadUserFromStorage()}loadUserFromStorage(){let e=localStorage.getItem(t.TOKEN),r=localStorage.getItem(t.USER);if(e&&r)try{let n=JSON.parse(r);this.currentUser.set(n),this.isAuthenticated.set(!0)}catch{this.clearAuth()}}login(e){return this.isLoading.set(!0),this.http.post(`${i.BASE_URL}${i.ENDPOINTS.AUTH.LOGIN}`,e).pipe(l(r=>{this.setAuth(r),this.isLoading.set(!1)}))}logout(){this.clearAuth(),this.router.navigate(["/auth/login"])}setAuth(e){localStorage.setItem(t.TOKEN,e.token),localStorage.setItem(t.REFRESH_TOKEN,e.refreshToken),localStorage.setItem(t.USER,JSON.stringify(e.user)),this.currentUser.set(e.user),this.isAuthenticated.set(!0)}clearAuth(){localStorage.removeItem(t.TOKEN),localStorage.removeItem(t.REFRESH_TOKEN),localStorage.removeItem(t.USER),this.currentUser.set(null),this.isAuthenticated.set(!1)}getToken(){return localStorage.getItem(t.TOKEN)}hasRole(e){let r=this.currentUser();return r?r.role===e:!1}static \u0275fac=function(r){return new(r||s)};static \u0275prov=u({token:s,factory:s.\u0275fac,providedIn:"root"})};export{h as a};
